<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unfixed Poem</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: #0b0f14;
  color: #cfd6df;
  font-family: serif;
}

#poem {
  max-width: 600px;
  margin: 20vh auto;
  text-align: center;
  font-size: 1.4em;
  line-height: 1.8;
}
.word {
  display: inline-block;
  margin: 4px;
  cursor: pointer;
  opacity: 0.85;
}
.word:active {
  opacity: 1;
}
.hint {
  position: fixed;
  bottom: 16px;
  width: 100%;
  text-align: center;
  font-size: 12px;
  opacity: 0.4;
}
</style>
</head>

<body>

<div id="poem">
Tell me who you are now<br>
Tell me what you do<br>
Tell me if this light shining on you is to be true
</div>

<div class="hint">tap a word</div>

<script>
let audio;
let unlocked = false;

function unlockAudio() {
  if (unlocked) return;
  audio = new (window.AudioContext || window.webkitAudioContext)();
  audio.resume();
  unlocked = true;
}

document.addEventListener("pointerdown", unlockAudio, { once: true });

function playTone(freq) {
  if (!audio) return;
  const osc = audio.createOscillator();
  const gain = audio.createGain();
  osc.frequency.value = freq;
  osc.type = "sine";
  gain.gain.setValueAtTime(0.08, audio.currentTime);
  gain.gain.exponentialRampToValueAtTime(0.001, audio.currentTime + 0.8);
  osc.connect(gain);
  gain.connect(audio.destination);
  osc.start();
  osc.stop(audio.currentTime + 0.8);
}

const poem = document.getElementById("poem");
const words = poem.innerText.split(/\s+/);
poem.innerHTML = "";

words.forEach((w, i) => {
  const span = document.createElement("span");
  span.className = "word";
  span.textContent = w + " ";
  span.addEventListener("pointerdown", e => {
    e.stopPropagation();
    playTone(300 + i * 22);
  });
  poem.appendChild(span);
});
</script>

</body>
</html>
